# Uniswap V3 Concentrated Liquidity

## uniswap V2 的问题

在 uniswap V2 中，流动性是按照 $x \cdot y = k$ 曲线，在整个价格区间 $(0,\infty)$ 上均匀分布的，也就是池子流动性允许以任何价格进行交易。

但是资产的历史价格会保持在一个确定的范围内，无论这个范围是宽还是窄，例如，ETH 的价格历史价格范围是 0.75 到 4800，USDC 的始终维系在 1 附近。没有人会以 5000 的价格购买一个 ETH。因此在远离当前价格或永远无法到达的价格区间提供流动性毫无意义，下面我们用数学模型来更直观的看看这会导致什么问题？

假设 ETH/USDT 交易对的现货价格为 1500 USDT/ETH，流动性池子中共有资金 4500USDT 和 3ETH。

用 x 表示 USDT，y 表示 ETH，$x_1$ = 4500, $y_1$ = 3, k = 13500

**如果价格下跌至 1300 USDT/ETH**, 此时则有：

$$
x_2 \cdot y_2 = 13500
$$

$$
\frac{x_2}{y_2} = 1300
$$

得: x_2 = 4192.54, y_2 = 3.22，也就是说在 1500 到 1300 这个价格区间，只有 $4500 - 4192.54 = 307.46$ USDT 在支撑流动性，资金利用率只有 $\frac{307.46}{4500} = 6.84\%$

**如果价格上涨至 1700USDT/ETH**, 此时则有：

$$
x_3 \cdot y_3 = 13500
$$

$$
\frac{x_3}{y_3} = 1700
$$

得：x_3 = 4789, y_3 = 2.817, 也就是说在 1500 到 1700 这个价格区间，只有 $3 - 2.817 = 0.183$ ETH 在支撑流动性，资金利用率只有 $\frac{0.183}{3} = 6.1\%$

从上面的例子中我们可以看出，假设 ETH 的价格在某一段时间内一直在 1300 - 1700 这个区间波动，而流动性被稀释到 $(0,\infty)$ 这个区间，资金利用率非常低，这会导致

- LP 的资金无法被充分利用，大部分流动性在支持无意义的价格区间，躺着发霉，LP 的收益降低
- 在一个 trader 频繁交易的价格区间内，流动性无法被充分利用，增大大额交易的 price impact。

而这个缺点在 USDT/DAT 这类稳定币交易对中会被放大，因为稳定币始终维持的 1 附近，价格区间非常小，资金利用率会进一步降低。为了解决这个问题，uniswap V3 引入了集中流动性。

## 集中流动性

为了解决这个问题，uniswap V3 引入了
